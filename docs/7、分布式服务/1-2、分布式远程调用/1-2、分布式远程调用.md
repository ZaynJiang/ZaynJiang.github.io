## 1. 什么是RPC
一句话概括：像调用本地方法一样去调用远程方法。
### 1.1. 基本原理
它的基本原理就是，客户端调用代理对象的方法，代理对象序列化请求方法参数，通过网络传输到服务端，服务端段反序列化调用的方法，找到对应的服务方法执行，再将结果放回给客户端的代理对象，代理对象将结果返回给客户端实际的调用者。    
![](远程调用模型.png)
需要注意的是如何去处理远程调用的异常
* 代理可以使用aop代理或者使用动态代理
* 序列化有多种选择：
  * Rmi、.net.remoting
  * 二进制类型Hessian、avro、kyro、fst
  * 文本，json或者xml
* 网络传输可以使用：
  * Tcp、ssl、netty等
  * http、https
* 查找服务  
  我们可以使用spring相关功能，比如根据class名称查找对应的bean
### 1.2. 有哪些rpc框架
* java rmi
* .net remoting
* Corba
* Jsonrpc xml rpc
* Webservice
* Thrift,最初是由 Facebook 开发的内部系统跨语言的 RPC 框架，2007 年贡献给了 Apache 基金，成为 Apache 开源项目之一，支持多种语言
* Grpc,通过 IDL(Interface Definition Language)文件定义服务接口的参数和返回值类型，然后通过代码生成程序生成服务端和客户端的具体实现代码，这样在 gRPC 里，客户端应用可以像调用本地对象一样调用另一台服务器上对应的方法

## 2. 如何设计一个rpc框架
### 2.1. 需要考虑的问题
* 如何定义调用格式，是通过共享接口还是idl
* 是采用aop还是动态代理
* 采用什么样的序列化方式，二进制还是文本
* 传输协议使用http还是tcp
* 如何查找服务，是自己写一套服务查找还是使用spring的注册方法
* 如何处理异常
### 2.2. 简单实现一个rpc框架
## 3. rpc框架和分布式服务
使用rpc框架来对现有服务实现分布式服务化需要考虑什么呢？  
在上面rpc技术的基础上，需要增加一些关于服务治理的考虑
* 多个相同的服务怎么管理
* 服务注册怎么实现
* 负载均衡和路由怎么实现
* 熔断、限流、重试怎么实现
* 如何做监控
* 如果实现高可用
* 是否需要跨语言支持
      

## 4. dubbo介绍  
### 4.1. dubbo历史
2011开源，2013之后维护程度很低，但是国内缺乏合适的rpc框架，使用率很高，2017重启维护，2018加入apache。  
阿里内部使用hsf框架。当当、京东在dubbo的基础上改造的rpc服务

### 4.2. dubbo特点
* 高性能rpc调用
* 负载均衡
* 服务注册和发现
* 扩展性强
* 流控
* 服务治理路由和运维，版本控制
* 使用非常简单
### 4.3. dubbo的应用
* 建设业务中台
* 单体服务化改造
* 直接为前端提供服务
### 4.4. dubbo整体架构
![](dubbo的整体架构.png)
#### 4.4.1. 服务的暴露和引用
#### 4.4.2. dubbo的spi
#### 4.4.3. dubbo路由和负载
#### 4.4.4. 泛化调用
#### 4.4.5. 隐式传参
#### 4.4.6. Mock



### 4.5. dubbo实践
#### 4.5.1. 分组与环境隔离
#### 4.5.2. 分包
#### 4.5.3. 泛化调用
#### 4.5.4. dubbo的重试和幂等
#### 4.5.5. 容器化部署
#### 4.5.6. 运维和监控

