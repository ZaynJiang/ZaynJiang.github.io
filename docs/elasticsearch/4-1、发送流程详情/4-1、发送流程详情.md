### 1. 开头
我们在前面已经知道elasticsearch底层的写入是基于lucence依进行doc写入的。elasticsearch作为一款分布式系统，在写入数据时还需要考虑很多重要的事项，比如:可靠性、原子性、一致性、实时性、隔离性、性能等多个指标。elasticsearch是如何做到的呢？下面我们针对elasticsearch的写入进行一步步分析。

### 2.1 最基本的写
elasticsearch拿到一个doc后调用lucnece的api进行写入：
```
 public long addDocument();
 public long updateDocuments();
 public long deleteDocuments();
```
如上面的代码所示，我们使用lucence的上面的接口就可以完成文档的增删改操作。